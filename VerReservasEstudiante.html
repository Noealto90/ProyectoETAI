<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ver Reservas - Estudiante</title>
    <link rel="stylesheet" href="VerReservasEstudiante.css">
</head>
<body>

<header>
    <h1>Reservas del Estudiante</h1>
    <p>Bienvenido, <?php echo htmlspecialchars($nombreUsuario); ?></p>
</header>

<div class="container">
    <h2>Listado de Reservas</h2>
    <div class="reservas">
        <?php if (!empty($reservas)): ?>
            <?php foreach ($reservas as $reserva): ?>
                <div class="card">
                    <h3>Laboratorio: <?php echo htmlspecialchars($reserva['laboratorio_id']); ?></h3>
                    <p><strong>Espacio:</strong> <?php echo htmlspecialchars($reserva['espacio_id']); ?></p>
                    <p><strong>Hora Inicio:</strong> <?php echo isset($reserva['horainicio']) ? htmlspecialchars($reserva['horainicio']) : 'No especificada'; ?></p>
                    <p><strong>Hora Final:</strong> <?php echo isset($reserva['horafinal']) ? htmlspecialchars($reserva['horafinal']) : 'No especificada'; ?></p>
                    <p><strong>Día:</strong> <?php echo isset($reserva['diar']) ? htmlspecialchars($reserva['diar']) : 'No especificado'; ?></p>
                    <p><strong>Acompañante:</strong> <?php echo !empty($reserva['nombreacompanante']) ? htmlspecialchars($reserva['nombreacompanante']) : 'N/A'; ?></p>
                    <p><strong>Estado:</strong> <?php echo $reserva['activa'] ? 'Activa' : 'Inactiva'; ?></p>
                    <form action="cancelarReserva.php" method="POST" onsubmit="return confirmarCancelacion()">
                        <input type="hidden" name="id" value="<?php echo $reserva['id']; ?>">
                        <button type="submit" class="cancel-btn">Cancelar Reserva</button>
                    </form>
                </div>
            <?php endforeach; ?>
        <?php else: ?>
            <p>No se encontraron reservas para este usuario.</p>
        <?php endif; ?>
    </div>
</div>

<footer>
    <p>© 2024 Estudiantes - Todos los derechos reservados</p>
</footer>

<?php if (isset($_GET['mensaje'])): ?>
    <div id="notification" class="notification <?php echo $_GET['mensaje'] == 'exito' ? '' : 'error'; ?>">
        <?php
        switch ($_GET['mensaje']) {
            case 'exito':
                echo 'Reserva cancelada con éxito.';
                break;
            case 'no_encontrada':
                echo 'No se encontró la reserva o ya estaba cancelada.';
                break;
            case 'error':
                echo 'Hubo un error al cancelar la reserva.';
                break;
            case 'falta_id':
                echo 'No se proporcionó un ID de reserva.';
                break;
        }
        ?>
    </div>
    <script>
        const notification = document.getElementById('notification');
        notification.classList.add('show');
        
        setTimeout(() => {
            notification.classList.remove('show');
        }, 3000);
    </script>
<?php endif; ?>

</body>
</html>
